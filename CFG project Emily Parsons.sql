CREATE DATABASE Book_store;
USE Book_store;

CREATE TABLE Authors(
id INT AUTO_INCREMENT NOT NULL,
Name VARCHAR(50) NOT NULL,
PRIMARY KEY (id)
);

-- populate Authors table
INSERT INTO Authors(Name)
VALUES("Stephen King"),
("Erin Morgenstern"),
("Brigid Kemmerer"),
("JRR Tolkien"),
("Roald Dahl"),
("CS Lewis"),
("Charles Dickens"),
("Taylor Jenkins Reid"),
("Colleen Hoover"),
("Ali Hazelwood"),
("Stephanie Garber"),
("Holly Jackson"),
("Madeline Miller"),
("Sally Rooney"),
("Suzanne Collins"),
("Richard Osman"),
("Sarah J Maas"),
("J K Rowling"),
("Matt Haig"),
("Frank Herbert"),
("Jeffrey Archer"),
("Caitlin Moran"),
("Hugh Howey"),
("David Walliams"),
("Goerge Orwell"),
("Julia Donaldson"),
("Dan Jones"),
("Jenny Han"),
("Ana Huang"),
("Jamie Littler"),
("Jeff Kinney"),
("Margaret Atwood"),
("Marian Keyes"),
("Florence Given"),
("Lauren Asher"),
("Markus Zusak"),
("Tom Hindle"),
("Ruth Jones"),
("Andrew Sean Greer"),
("Nick Bradley"),
("Mike Gayle"),
("Ian Rankin"),
("Lee Child"),
("Elizabeth Lim"),
("Hugh Howey"),
("Ray Bradbury"),
("Kelly Barnhill"),
("Alice Oseman"),
("Dav Pilkey"),
("Jamie Smart"),
("Judith Kerr"),
("Eric Carle"),
("Nathan Bryon"),
("Michael Rosen"),
("Lynley Dodd"),
("Shirley Hughes"),
("Maurice Sendak"),
("David McKee");

SELECT * FROM Authors;

UPDATE Authors
SET name = 'George Orwell'
WHERE id = 25;

DELETE FROM Authors
WHERE id = 45;

CREATE TABLE Books(
id INT AUTO_INCREMENT NOT NULL,
Title VARCHAR(100) NOT NULL,
Author_id INT NOT NULL,
Published_year DATE,
Genre VARCHAR(50),
Cost DECIMAL(10,2),
PRIMARY KEY (id),
FOREIGN KEY (Author_id) REFERENCES Authors(id)
);

-- populate Books table
INSERT INTO Books (Title, Author_id, Published_year, Genre, Cost)
VALUES("The shining",1,"2007-05-31","Horror",10.99),
("Fairy tale",1,"2023-06-08","Horror",7.99),
("Misery",1,"2007-05-31","Horror",9.99),
("IT",1,"2011-05-12","Horror",12.99),
("Carrie",1,"2011-10-13","Horror",8.99),
("The mist",1,"2021-09-09","Horror",7.99),
("The night circus",2,"2016-10-06","YA",9.99),
("The starless sea",2,"2020-08-06","Fantasy",9.99),
("Forging silver into stars",3,"2022-06-07","Fantasy",8.99),
("A curse so dark and lonely",3,"2019-01-29","Fantasy",8.99),
("A heart so fierce and broken",3,"2020-01-07","Fantasy",7.99),
("A vow so bold and deadly",3,"2021-01-26","Fantasy",7.99),
("Defy the night",3,"2021-09-14","Fantasy",8.99),
("Defend the dawn",3,"2022-09-20","Fantasy",8.99),
("The hobbit",4,"1996-05-07","Fantasy",8.99),
("The fellowship of the ring",4,"1997-11-03","Fantasy",9.99),
("The two towers",4,"1997-11-03","Fantasy",9.99),
("The return of the king",4,"1997-11-03","Fantasy",9.99),
("The BFG",5,"1982-01-14","Children",7.99),
("The witches",5,"1983-10-27","Children",7.99),
("The lion, the witch and the wardrobe",6,"1950-10-16","Children",14.99),
("Alice's adventures in wonderland",6,"1865-11-19","Children",7.99),
("A Christmas carol",7,"1843-12-19","Fiction",7.99),
("The seven husbands of Evelyn Hugo",8,"2021-10-14","Romance",7.49),
("Daisy Jones and the six",8,"2020-01-09","Romance",7.99),
("It starts with us",9,"2023-07-06","Romance",7.99),
("It ends with us",9,"2016-08-02","Romance",7.49),
("Love Theoretically",10,"2023-06-13","Romance",8.49),
("The love hypothesis",10,"2021-10-21","Romance",8.99),
("Love on the brain",10,"2022-08-23","Romance",7.49),
("Caraval",11,"2017-11-30","Fantasy",9.99),
("Once upon a broken heart",11,"2022-06-30","Fantasty",9.99),
("A good girl's guide to murder",12,"2019-05-02","Thriller",6.99),
("Good girl bad blood",12,"2020-04-30","Thriller",8.99),
("The song of Achilles",13,"2017-09-21","Fiction",9.99),
("Normal people",14,"2019-05-02","Romance",7.99),
("Conversations with friends",14,"2018-03-01","Fiction",9.99),
("Beautiful world where are you",14,"2022-06-07","Fiction",7.49),
("The hunger games",15,"2011-12-01","Fiction",8.99),
("The ballad of songbirds and snakes",15,"2021-07-08","Fantasy",7.49),
("The bullet that missed",16,"2023-05-11","Fiction",7.99),
("A court of thorns and roses",17,"2015-05-05","Fantasy",8.99),
("A court of mist and fury",17,"2016-04-22","Fantasy",8.99),
("Harry Potter and the philosopher's stone",18,"1997-06-26","Fantasy",7.99),
("The midnight library",19,"2021-02-18","Fiction",7.49),
("To be a cat",19,"2013-05-02","Children",7.99),
("Dune",20,"2015-07-16","Fiction",9.99),
("Next in line",21,"2023-05-25","Crime",7.49),
("Hidden in plain sight",21,"2021-03-04","Crime",9.99),
("How to be a woman",22,"2012-03-01","Biography",9.99),
("How to build a girl",22,"2015-04-09","Fiction",10.99),
("Wool",23,"2023-04-13","Fiction",8.49),
("Gangsta granny",24,"2013-02-22","Children",7.99),
("Spaceboy",24,"2022-09-29","Children",10.99),
("Animal farm",25,"2000-02-24","Fiction",7.99),
("The Gruffalo",26,"2017-04-06","Children",5.99),
("Room on the broom",26,"2016-04-21","Children",7.99),
("The snail and the whale",26,"2017-04-06","Children",7.99),
("Essex dogs",27,"2023-07-06","Fiction",8.49),
("The summer I turned pretty",28,"2022-04-28","Romance",8.99),
("King of wrath",29,"2022-11-29","Romance",8.49),
("Twisted love",29,"2022-05-05","Romance",9.99),
("Arkspire",30,"2023-07-06","Children",6.49),
("Frostheart",30,"2019-10-03","Children",7.99),
("Diary of a wimpy kid",31,"2008-07-03","Children",7.99),
("The handmaid's tale",32,"1996-09-19","Fiction",9.99),
("The Penelopiad",32,"2018-04-05","Fiction",9.99),
("Grown ups",33,"2021-02-04","Fiction",9.99),
("Watermelon",33,"2017-07-06","Fiction",9.99),
("Girl crush",34,"2023-06-22","Fiction",7.99),
("Women don't owe you pretty",34,"2021-09-09","Biography",8.99),
("The fine print",35,"2022-01-27","Romance",9.99),
("The book thief",36,"2016-09-15","Fiction",8.99),
("A fatal crossing",37,"2022-01-20","Thriller",14.99),
("Love untold",38,"2023-07-06","Fiction",7.99),
("Never greener",38,"2019-05-30","Romance",9.99),
("Less is lost",39,"2023-07-06","Fiction",8.49),
("Four seasons in Japan",40,"2023-06-22","Fiction",14.99),
("All the lonely people",41,"2021-02-04","Fiction",8.99),
("Hide and seek",42,"2011-08-04","Crime",8.99),
("Blue moon",43,"2020-04-02","Thriller",9.99),
("The dragon's promise",44,"2022-08-30","Fantasy",16.99),
("Unravel the dusk",44,"2021-06-01","Fantasy",8.99),
("Fahrenheit 451",46,"1993-08-16","Fiction",8.99),
("When women were dragons",47,"2023-06-08","Fantasy",7.49),
("The girl who drank the moon",47,"2017-08-24","Children",7.99),
("Heartstopper",48,"2019-02-07","YA",10.99),
("Solitaire",48,"2014-07-31","YA",9.99),
("Dog man",49,"2017-07-06","Children",8.99),
("Looshkin",50,"2018-05-03","Children",8.99),
("The tiger who came to tea",51,"1968-01-30","Children",7.99),
("Mog the forgetful cat",51,"1970-02-06","Children",6.99),
("The very hungry caterpillar",52,"1994-09-29","Children",7.99),
("Look up",53,"2019-06-13","Children",6.99),
("Speak up",53,"2023-05-25","Children",6.49),
("We're going on a bear hunt",54,"1993-09-16","Children",7.99),
("Hairy Maclary from Donaldson's dairy",55,"1983-07-04","Children",7.99),
("Dogger",56,"1977-02-05","Children",7.99),
("Where the wild things are",57,"1963-04-09","Children",8.99),
("Not now Bernard",58,"1980-06-04","Children",7.99),
("Elmer",58,"1968-09-06","Children",6.99);

SELECT * FROM Books;

CREATE TABLE Store(
id INT AUTO_INCREMENT NOT NULL,
City VARCHAR(25) NOT NULL,
Phone_number VARCHAR(11) NOT NULL,
PRIMARY KEY(id)
);

-- Populate Store table
INSERT INTO Store(City, Phone_number)
VALUES ('Birmingham', '07127658945'),
('Telford', '07998453709'),
('Cardiff', '07123764122'),
('Liverpool', '07892167543'),
('Oxford', '07160229072');

SELECT * FROM Store;

CREATE TABLE Suppliers(
id INT AUTO_INCREMENT NOT NULL,
Name VARCHAR(25) NOT NULL,
Contact VARCHAR(11) NOT NULL,
Location VARCHAR(50) NOT NULL,
PRIMARY KEY(id)
);

-- Populate Suppliers table
INSERT INTO Suppliers(Name, Contact, Location)
VALUES('Booksy', '07768510964', 'Cardiff'),
('Penguin', '07133245548', 'London'),
('Pages', '07114589067', 'Portsmouth');

SELECT * FROM Suppliers;

CREATE TABLE Customers(
id INT AUTO_INCREMENT NOT NULL,
First_name VARCHAR(25) NOT NULL,
Last_name VARCHAR(25) NOT NULL,
Phone_number VARCHAR(11),
Email_address VARCHAR(100) NOT NULL,
Address VARCHAR(250) NOT NULL,
Postcode VARCHAR(8) NOT NULL,
PRIMARY KEY(id)
);

-- Populate Customers table
INSERT INTO Customers(First_name, Last_name, Phone_number, Email_address, Address, Postcode)
VALUES("Olivia","Smith","07123456789","Olivia.Smith@gmail.com","123 Main Street, London","SW1A 1AA"),
("Amelia","Jones","07234567890","Amelia.Jones@gmail.com","456 High Road, Manchester","M1 2AB"),
("Isla","Williams","07345678901","Isla.Williams@gmail.com","789 Park Avenue, Birmingham","B2 3CD"),
("Ava","Brown","07456789012","Ava.Brown@gmail.com","321 Elm Court, Glasgow","G1 4DE"),
("Mia","Taylor","07567890123","Mia.Taylor@gmail.com","987 Oak Lane, Liverpool","L3 5EF"),
("Isabella","Davies","07678901234","Isabella.Davies@gmail.com","654 Maple Crescent, Edinburgh","EH6 6FG"),
("Sophia","Wilson","07789012345","Sophia.Wilson@gmail.com","147 Birch Close, Leeds","LS7 7GH"),
("Grace","Evans","07890123456","Grace.Evans@gmail.com","258 Pine Terrace, Newcastle","NE1 8HI"),
("Lily","Thomas","07901234567","Lily.Thomas@gmail.com","369 Cedar Way, Sheffield","S2 9IJ"),
("Freya","Johnson","07012345678","Freya.Johnson@gmail.com","741 Elm Grove, Bristol","BS1 0JK"),
("Emily","Roberts","07123456789","Emily.Roberts@gmail.com","852 Birch Place, Cardiff","CF1 1KL"),
("Ivy","Walker","07234567890","Ivy.Walker@gmail.com","963 Willow Court, Nottingham","NG1 2LM"),
("Evie","Wright","07345678901","Evie.Wright@gmail.com","874 Oakwood Lane, Belfast","BT1 3MN"),
("Ella","Robinson","07456789012","Ella.Robinson@gmail.com","785 Elm Street, Southampton","SO1 4NO"),
("Harper","Thompson","07567890123","Harper.Thompson@gmail.com","852 Parkside Avenue, Oxford","OX1 5OP"),
("Aria","White","07678901234","Aria.White@gmail.com","963 Pinehurst Road, Cambridge","CB1 6PQ"),
("Rosie","Hughes","07789012345","Rosie.Hughes@gmail.com","741 Elmwood Close, York","YO1 7QR"),
("Poppy","Green","07890123456","Poppy.Green@gmail.com","365 Cedarwood Place, Reading","RG1 8RS"),
("Charlotte","Hall","07901234567","Charlotte.Hall@gmail.com","258 Ashford Drive, Brighton","BN1 9ST"),
("Ruby","Lewis","07012345678","Ruby.Lewis@gmail.com","147 Birchfield Terrace, Coventry","CV1 0TU"),
("Elsie","Harris","07123456789","Elsie.Harris@gmail.com","369 Oakridge Court, Aberdeen","AB1 2UV"),
("Scarlett","Clarke","07234567890","Scarlett.Clarke@gmail.com","753 Park Lane, Exeter","EX1 3WX"),
("Chloe","Patel","07345678901","Chloe.Patel@gmail.com","926 Highfield Road, Hull","HU1 4XY"),
("Sienna","Jackson","07456789012","Sienna.Jackson@gmail.com","815 Mapleview Avenue, Portsmouth","PO1 5YZ"),
("Florence","Wood","07567890123","Florence.Wood@gmail.com","682 Elmwood Lane, Derby","DE1 6ZA"),
("Oliver","Turner","07678901234","Oliver.Turner@gmail.com","537 Willowbrook Place, Stoke-on-Trent","ST1 7AB"),
("George","Martin","07789012345","George.Martin@gmail.com","624 Birchwood Grove, Swansea","SA1 8BC"),
("Noah","Ward","07890123456","Noah.Ward@gmail.com","273 Oakdale Drive, Preston","PR1 9CD"),
("Arthur","Morgan","07901234567","Arthur.Morgan@gmail.com","350 Pinefield Street, Coventry","CV1 0DE"),
("Freddie","Cooper","07012345678","Freddie.Cooper@gmail.com","467 Elm Court, Leicester","LE1 2EF"),
("Harry","Hill","07123456789","Harry.Hill@gmail.com","854 Parkview Road, Newport","NP1 5FG"),
("Leo","Clark","07234567890","Leo.Clark@gmail.com","999 Highgrove Avenue, Milton Keynes","MK1 6GH"),
("Charlie","Harrison","07345678901","Charlie.Harrison@gmail.com","222 Ashford Lane, Bradford","BD1 7HI"),
("Muhammad","Allen","07456789012","Muhammad.Allen@gmail.com","111 Birchwood Road, Edinburgh","EH1 4IJ"),
("Oscar","Carter","07567890123","Oscar.Carter@gmail.com","888 Elmwood Place, Birmingham","G1 0MN"),
("Jack","Parker","07678901234","Jack.Parker@gmail.com","777 Oak Lane, Leeds","M1 2NO"),
("Henry","Davis","07789012345","Henry.Davis@gmail.com","666 Park Terrace, Sheffield","SW1A 3OP"),
("Alfie","Price","07890123456","Alfie.Price@gmail.com","555 Pineview Grove, Glasgow","L1 4PQ"),
("Theo","Bennett","07901234567","Theo.Bennett@gmail.com","444 Cedarwood Crescent, Manchester","NE1 5QR"),
("William","Young","07012345678","William.Young@gmail.com","333 Willow Terrace, London","BS1 6RS"),
("Joshua","Mitchell","07123456789","Joshua.Mitchell@gmail.com","222 Highgrove Close, Liverpool","EH1 7ST"),
("Ethan","King","07234567890","Ethan.King@gmail.com","101 Maple Drive, Newcastle","B1 8TU"),
("Thomas","Scott","07345678901","Thomas.Scott@gmail.com","777 Elm Road, Bristol","LS1 9UV"),
("James","Watson","07456789012","James.Watson@gmail.com","999 Parkside Avenue, Edinburgh","S1 0WX"),
("Alexander","Morris","07567890123","Alexander.Morris@gmail.com","222 Birchfield Lane, Birmingham","G1 1YZ"),
("Jacob","Cook","07678901234","Jacob.Cook@gmail.com","333 Oakwood Place, Leeds","M1 2AB"),
("Max","Turner","07789012345","Max.Turner@gmail.com","444 Pinehurst Road, Sheffield","SW1A 3CD"),
("Benjamin","Hill","07890123456","Benjamin.Hill@gmail.com","555 Elmwood Court, Glasgow","L1 4PQ"),
("Logan","Roberts","07901234567","Logan.Roberts@gmail.com","666 Cedar Lane, Manchester","NE1 5QR"),
("Lucas","Gray","07012345678","Lucas.Gray@gmail.com","777 Willow Avenue, London","BS1 6RS");

SELECT * FROM Customers;

CREATE TABLE Inventory(
Book_id INT NOT NULL,
Store_id INT NOT NULL,
Stock_level INT NOT NULL,
PRIMARY KEY(Book_id, Store_id),
FOREIGN KEY(Book_id) REFERENCES Books(id),
FOREIGN KEY(Store_id) REFERENCES Store(id)
);

INSERT INTO Inventory(Book_id, Store_id, Stock_level)
VALUES(1,1,4),
(2,1,10),
(3,1,2),
(4,1,1),
(5,1,0),
(6,1,5),
(7,1,14),
(8,1,2),
(9,1,4),
(10,1,4),
(11,1,11),
(12,1,11),
(13,1,12),
(14,1,7),
(15,1,4),
(16,1,15),
(17,1,14),
(18,1,8),
(19,1,6),
(20,1,11),
(21,1,3),
(22,1,13),
(23,1,8),
(24,1,7),
(25,1,8),
(26,1,3),
(27,1,6),
(28,1,3),
(29,1,11),
(30,1,1),
(31,1,10),
(32,1,12),
(33,1,5),
(34,1,13),
(35,1,3),
(36,1,8),
(37,1,15),
(38,1,2),
(39,1,11),
(40,1,10),
(41,1,2),
(42,1,3),
(43,1,9),
(44,1,4),
(45,1,15),
(46,1,2),
(47,1,0),
(48,1,12),
(49,1,2),
(50,1,2),
(51,1,1),
(52,1,12),
(53,1,7),
(54,1,5),
(55,1,9),
(56,1,11),
(57,1,7),
(58,1,4),
(59,1,3),
(60,1,15),
(61,1,15),
(62,1,14),
(63,1,11),
(64,1,1),
(65,1,11),
(66,1,12),
(67,1,6),
(68,1,6),
(69,1,2),
(70,1,13),
(71,1,12),
(72,1,4),
(73,1,4),
(74,1,5),
(75,1,14),
(76,1,0),
(77,1,9),
(78,1,1),
(79,1,1),
(80,1,12),
(81,1,0),
(82,1,15),
(83,1,6),
(84,1,9),
(85,1,15),
(86,1,14),
(87,1,1),
(88,1,5),
(89,1,13),
(90,1,14),
(91,1,8),
(92,1,10),
(93,1,15),
(94,1,0),
(95,1,7),
(96,1,6),
(97,1,14),
(98,1,0),
(99,1,2),
(100,1,1),
(101,1,6),
(1,2,2),
(2,2,14),
(3,2,1),
(4,2,7),
(5,2,12),
(6,2,9),
(7,2,3),
(8,2,1),
(9,2,14),
(10,2,8),
(11,2,14),
(12,2,11),
(13,2,11),
(14,2,10),
(15,2,0),
(16,2,12),
(17,2,2),
(18,2,10),
(19,2,12),
(20,2,12),
(21,2,7),
(22,2,1),
(23,2,1),
(24,2,7),
(25,2,4),
(26,2,12),
(27,2,15),
(28,2,0),
(29,2,11),
(30,2,1),
(31,2,5),
(32,2,0),
(33,2,3),
(34,2,14),
(35,2,11),
(36,2,6),
(37,2,7),
(38,2,12),
(39,2,15),
(40,2,1),
(41,2,8),
(42,2,2),
(43,2,1),
(44,2,5),
(45,2,12),
(46,2,12),
(47,2,10),
(48,2,11),
(49,2,5),
(50,2,1),
(51,2,3),
(52,2,8),
(53,2,13),
(54,2,3),
(55,2,6),
(56,2,9),
(57,2,2),
(58,2,5),
(59,2,15),
(60,2,12),
(61,2,6),
(62,2,5),
(63,2,10),
(64,2,1),
(65,2,13),
(66,2,12),
(67,2,15),
(68,2,10),
(69,2,10),
(70,2,10),
(71,2,2),
(72,2,6),
(73,2,1),
(74,2,14),
(75,2,6),
(76,2,8),
(77,2,3),
(78,2,0),
(79,2,3),
(80,2,9),
(81,2,12),
(82,2,6),
(83,2,1),
(84,2,8),
(85,2,11),
(86,2,3),
(87,2,11),
(88,2,4),
(89,2,5),
(90,2,11),
(91,2,15),
(92,2,7),
(93,2,15),
(94,2,4),
(95,2,4),
(96,2,4),
(97,2,12),
(98,2,4),
(99,2,13),
(100,2,12),
(101,2,13),
(1,3,8),
(2,3,3),
(3,3,2),
(4,3,1),
(5,3,7),
(6,3,9),
(7,3,9),
(8,3,15),
(9,3,3),
(10,3,2),
(11,3,15),
(12,3,11),
(13,3,15),
(14,3,4),
(15,3,4),
(16,3,11),
(17,3,4),
(18,3,3),
(19,3,7),
(20,3,0),
(21,3,12),
(22,3,5),
(23,3,7),
(24,3,12),
(25,3,8),
(26,3,13),
(27,3,13),
(28,3,9),
(29,3,5),
(30,3,5),
(31,3,10),
(32,3,14),
(33,3,9),
(34,3,1),
(35,3,8),
(36,3,0),
(37,3,2),
(38,3,7),
(39,3,12),
(40,3,6),
(41,3,10),
(42,3,11),
(43,3,11),
(44,3,10),
(45,3,15),
(46,3,11),
(47,3,5),
(48,3,12),
(49,3,8),
(50,3,13),
(51,3,5),
(52,3,1),
(53,3,6),
(54,3,1),
(55,3,14),
(56,3,12),
(57,3,0),
(58,3,10),
(59,3,14),
(60,3,1),
(61,3,10),
(62,3,8),
(63,3,11),
(64,3,6),
(65,3,10),
(66,3,6),
(67,3,4),
(68,3,8),
(69,3,5),
(70,3,0),
(71,3,9),
(72,3,7),
(73,3,5),
(74,3,9),
(75,3,7),
(76,3,13),
(77,3,0),
(78,3,0),
(79,3,8),
(80,3,10),
(81,3,11),
(82,3,11),
(83,3,8),
(84,3,10),
(85,3,0),
(86,3,6),
(87,3,3),
(88,3,12),
(89,3,11),
(90,3,5),
(91,3,11),
(92,3,5),
(93,3,11),
(94,3,0),
(95,3,9),
(96,3,9),
(97,3,11),
(98,3,1),
(99,3,6),
(100,3,12),
(101,3,3),
(1,4,7),
(2,4,5),
(3,4,10),
(4,4,0),
(5,4,0),
(6,4,7),
(7,4,2),
(8,4,14),
(9,4,5),
(10,4,9),
(11,4,9),
(12,4,14),
(13,4,11),
(14,4,1),
(15,4,9),
(16,4,1),
(17,4,0),
(18,4,15),
(19,4,12),
(20,4,5),
(21,4,14),
(22,4,15),
(23,4,10),
(24,4,13),
(25,4,0),
(26,4,5),
(27,4,8),
(28,4,7),
(29,4,7),
(30,4,15),
(31,4,12),
(32,4,11),
(33,4,12),
(34,4,6),
(35,4,8),
(36,4,3),
(37,4,1),
(38,4,6),
(39,4,6),
(40,4,14),
(41,4,9),
(42,4,9),
(43,4,0),
(44,4,0),
(45,4,7),
(46,4,4),
(47,4,11),
(48,4,11),
(49,4,11),
(50,4,1),
(51,4,1),
(52,4,6),
(53,4,4),
(54,4,7),
(55,4,2),
(56,4,3),
(57,4,14),
(58,4,2),
(59,4,7),
(60,4,0),
(61,4,6),
(62,4,13),
(63,4,3),
(64,4,2),
(65,4,7),
(66,4,7),
(67,4,11),
(68,4,6),
(69,4,7),
(70,4,1),
(71,4,6),
(72,4,0),
(73,4,9),
(74,4,9),
(75,4,9),
(76,4,12),
(77,4,1),
(78,4,9),
(79,4,8),
(80,4,7),
(81,4,4),
(82,4,15),
(83,4,1),
(84,4,2),
(85,4,0),
(86,4,0),
(87,4,12),
(88,4,0),
(89,4,10),
(90,4,0),
(91,4,14),
(92,4,15),
(93,4,15),
(94,4,15),
(95,4,8),
(96,4,6),
(97,4,1),
(98,4,8),
(99,4,2),
(100,4,12),
(101,4,8),
(1,5,5),
(2,5,4),
(3,5,3),
(4,5,12),
(5,5,8),
(6,5,4),
(7,5,0),
(8,5,1),
(9,5,2),
(10,5,11),
(11,5,8),
(12,5,1),
(13,5,6),
(14,5,15),
(15,5,13),
(16,5,3),
(17,5,2),
(18,5,15),
(19,5,6),
(20,5,13),
(21,5,9),
(22,5,7),
(23,5,10),
(24,5,1),
(25,5,11),
(26,5,7),
(27,5,6),
(28,5,10),
(29,5,1),
(30,5,0),
(31,5,10),
(32,5,13),
(33,5,4),
(34,5,5),
(35,5,8),
(36,5,15),
(37,5,7),
(38,5,11),
(39,5,15),
(40,5,1),
(41,5,5),
(42,5,8),
(43,5,0),
(44,5,14),
(45,5,11),
(46,5,13),
(47,5,1),
(48,5,14),
(49,5,9),
(50,5,4),
(51,5,6),
(52,5,13),
(53,5,2),
(54,5,3),
(55,5,0),
(56,5,11),
(57,5,4),
(58,5,13),
(59,5,15),
(60,5,9),
(61,5,12),
(62,5,11),
(63,5,7),
(64,5,13),
(65,5,10),
(66,5,0),
(67,5,7),
(68,5,5),
(69,5,14),
(70,5,4),
(71,5,1),
(72,5,15),
(73,5,0),
(74,5,5),
(75,5,15),
(76,5,13),
(77,5,5),
(78,5,6),
(79,5,6),
(80,5,7),
(81,5,3),
(82,5,8),
(83,5,4),
(84,5,11),
(85,5,15),
(86,5,7),
(87,5,11),
(88,5,0),
(89,5,15),
(90,5,2),
(91,5,13),
(92,5,8),
(93,5,14),
(94,5,9),
(95,5,0),
(96,5,1),
(97,5,8),
(98,5,8),
(99,5,11),
(100,5,12),
(101,5,7);

SELECT * FROM Inventory;

CREATE TABLE Stock_orders(
id INT AUTO_INCREMENT NOT NULL,
Supplier_id INT NOT NULL,
Book_id INT NOT NULL,
Cost DECIMAL(10,2),
Quantity INT,
Store_id INT NOT NULL,
Date_ordered DATE,
Date_recieved DATE,
PRIMARY KEY(id),
FOREIGN KEY(Supplier_id) REFERENCES Suppliers(id),
FOREIGN KEY(Book_id) REFERENCES Books(id),
FOREIGN KEY(Store_id) REFERENCES Store(id)
);

-- populate stock orders table
INSERT INTO Stock_orders(Supplier_id, Book_id, Cost, Quantity, Store_id, Date_ordered, Date_recieved)
VALUES(1,81,30,24,3,"2023-01-02","2023-01-07"),
(3,80,22.5,18,3,"2023-01-26","2023-01-30"),
(2,68,30,24,3,"2023-02-07","2023-02-14"),
(2,5,20,16,1,"2023-02-16","2023-02-20"),
(3,20,25,20,3,"2023-03-04","2023-03-11"),
(1,90,21.25,17,5,"2023-03-17","2023-03-21"),
(2,19,28.75,23,1,"2023-04-28","2023-05-02"),
(1,14,28.75,23,1,"2023-04-28","2023-05-04"),
(2,61,35,28,1,"2023-05-05","2023-05-10"),
(1,76,21.25,17,5,"2023-05-24","2023-05-28"),
(2,91,32.5,26,2,"2023-05-29","2023-06-03"),
(3,9,30,24,1,"2023-06-01","2023-06-06"),
(1,25,26.25,21,4,"2023-06-23","2023-06-30"),
(2,44,15,12,5,"2023-07-03","2023-07-09"),
(3,42,30,24,5,"2023-07-24",NULL);

SELECT * FROM Stock_orders;

CREATE TABLE Sales(
id INT AUTO_INCREMENT NOT NULL,
Store_id INT NOT NULL,
Customer_id INT NOT NULL,
Total DECIMAL(10,2) NOT NULL,
Date_sold DATE NOT NULL,
PRIMARY KEY(id),
FOREIGN KEY(Store_id) REFERENCES Store(id),
FOREIGN KEY(Customer_id) REFERENCES Customers(id)
);

INSERT INTO Sales(Store_id, Customer_id, Total, Date_sold)
VALUES(5,33,23.98,"2023-02-08"),
(1,34,27.97,"2023-05-07"),
(4,3,7.99,"2023-06-12"),
(2,1,16.98,"2023-03-25"),
(1,2,29.97,"2023-07-09"),
(4,6,33.96,"2023-01-23"),
(2,44,28.97,"2023-04-02"),
(2,32,19.98,"2023-05-29"),
(4,31,31.97,"2023-02-15"),
(4,30,51.95,"2023-07-19"),
(5,17,16.98,"2023-04-22"),
(3,23,26.97,"2023-01-21"),
(2,31,26.47,"2023-06-20"),
(2,29,17.98,"2023-03-04"),
(2,26,9.99,"2023-05-21"),
(2,36,18.48,"2023-01-28"),
(2,4,27.97,"2023-03-18"),
(3,29,22.98,"2023-06-28"),
(5,14,21.97,"2023-05-17"),
(3,27,30.46,"2023-04-15"),
(5,17,23.97,"2023-07-15"),
(4,8,25.47,"2023-02-03"),
(1,32,33.46,"2023-05-27"),
(4,22,17.48,"2023-07-05"),
(2,31,30.97,"2023-06-16"),
(5,34,6.99,"2023-01-06"),
(4,45,16.48,"2023-04-07"),
(3,44,24.47,"2023-03-14"),
(4,23,16.98,"2023-02-10"),
(1,28,32.46,"2023-07-23"),
(1,44,13.98,"2023-05-12"),
(3,13,19.98,"2023-06-30"),
(5,24,14.98,"2023-03-31"),
(2,44,17.48,"2023-01-11"),
(1,40,22.98,"2023-07-02"),
(2,49,26.47,"2023-04-11"),
(3,19,18.98,"2023-06-07"),
(3,6,17.98,"2023-02-22"),
(4,9,5.99,"2023-01-03"),
(3,14,31.97,"2023-05-01"),
(2,39,33.96,"2023-07-11"),
(3,6,27.97,"2023-03-27"),
(3,41,7.99,"2023-02-06"),
(4,23,22.98,"2023-06-25"),
(1,33,27.97,"2023-04-08"),
(4,44,19.98,"2023-01-18"),
(5,31,16.98,"2023-07-13"),
(3,16,27.98,"2023-03-07"),
(1,42,26.97,"2023-05-25"),
(3,41,25.97,"2023-06-10");

SELECT * FROM Sales;

CREATE TABLE Items_sold(
id INT AUTO_INCREMENT NOT NULL,
Sale_id INT NOT NULL,
Book_id INT NOT NULL,
Quantity INT NOT NULL,
PRIMARY KEY(id),
FOREIGN KEY(Sale_id) REFERENCES Sales(id),
FOREIGN KEY(Book_id) REFERENCES Books(id)
);

-- populate Items_sold
INSERT INTO Items_sold(Sale_id, Book_id, Quantity)
VALUES(1,1,1),
(1,4,1),
(2,29,1),
(2,18,1),
(2,89,1),
(3,2,1),
(4,3,1),
(4,101,1),
(5,4,1),
(5,100,1),
(5,5,1),
(6,5,1),
(6,99,1),
(6,98,1),
(6,97,1),
(7,6,1),
(7,7,1),
(7,1,1),
(8,8,2),
(9,9,1),
(9,21,1),
(9,96,1),
(10,10,1),
(10,11,1),
(10,4,1),
(10,1,2),
(11,12,1),
(11,13,1),
(12,14,1),
(12,35,1),
(12,26,1),
(13,15,1),
(13,27,1),
(13,3,1),
(14,16,1),
(14,2,1),
(15,17,1),
(16,18,1),
(16,59,1),
(17,19,1),
(17,68,1),
(17,67,1),
(18,20,1),
(18,21,1),
(19,22,1),
(19,33,1),
(19,94,1),
(20,23,1),
(20,24,1),
(20,93,1),
(20,92,1),
(21,25,1),
(21,26,1),
(21,91,1),
(22,27,1),
(22,90,1),
(22,89,1),
(23,28,1),
(23,29,1),
(23,65,2),
(24,30,1),
(24,31,1),
(25,32,1),
(25,88,1),
(25,87,1),
(26,33,1),
(27,34,1),
(27,38,1),
(28,39,1),
(28,40,1),
(28,19,1),
(29,41,1),
(29,42,1),
(30,43,1),
(30,44,1),
(30,45,1),
(30,25,1),
(31,46,1),
(31,56,1),
(32,47,1),
(32,81,1),
(33,48,2),
(34,49,1),
(34,24,1),
(35,50,1),
(35,4,1),
(36,52,1),
(36,36,1),
(36,37,1),
(37,53,1),
(37,54,1),
(38,55,1),
(38,37,1),
(39,56,1),
(40,57,1),
(40,78,1),
(40,79,1),
(41,58,1),
(41,59,1),
(41,60,1),
(41,61,1),
(42,62,1),
(42,68,1),
(42,44,1),
(43,64,1),
(44,65,1),
(44,74,1),
(45,66,1),
(45,42,1),
(45,43,1),
(46,67,1),
(46,68,1),
(47,70,1),
(47,71,1),
(48,74,1),
(48,4,1),
(49,29,1),
(49,7,1),
(49,22,1),
(50,7,1),
(50,2,1),
(50,96,1);

SELECT * FROM Items_sold;

-- John wants to know the stock level for each book at each store
SELECT 
Books.title AS 'Book',
Store.city AS 'Store',
Inventory.Stock_level AS 'Stock level'
FROM Inventory
JOIN Books ON Inventory.book_id = Books.id
JOIN Store ON Inventory.store_id = Store.id;

-- Stored function. Oxford store wanted to check their stock status
DELIMITER //
CREATE FUNCTION check_stock(Stock_level INT)
RETURNS VARCHAR(20)
DETERMINISTIC
BEGIN
  DECLARE status VARCHAR(20);
  IF Stock_level = 0 THEN
    SET status='Out of stock';
  ELSEIF Stock_level < 5 THEN
    SET status='Low stock';
  ELSE
    SET status='High stock';
  END IF;
  RETURN (status);
   
END//

DELIMITER ;

SELECT 
Books.title AS 'Book',
Store.city AS 'Store',
check_stock(Stock_level) AS 'Status'
FROM Inventory
JOIN Books ON Inventory.book_id = Books.id
JOIN Store ON Inventory.store_id = Store.id
WHERE Store.city = 'Oxford'
ORDER BY Status;

-- Stored procedure. John wants to know how many sales were made in a given month for each store.
DELIMITER //
CREATE PROCEDURE Get_sales_by_month (month VARCHAR(2))
BEGIN
SELECT Store_id AS 'Store', 
SUM(Total) AS 'Monthly total', 
Count(Store_id) AS 'Sales made'
FROM Sales
WHERE SUBSTRING(Date_sold, 6, 2) = month
GROUP BY Store_id;
END//
DELIMITER ;

CALL Get_sales_by_month('07');

-- Lewis wants to know which books have not had any sales across all stores.
SELECT title AS 'Unsold books'
FROM Books
WHERE id NOT IN (
SELECT Book_id FROM Items_sold);

-- Gerald wants to know which orders have not yet been fulfilled
SELECT 
Stock_orders.id AS 'Order id',
Books.title AS 'Title',
Suppliers.name AS 'Supplier',
Store.city AS 'Store'
FROM Stock_orders
JOIN Books ON Stock_orders.book_id = Books.id
JOIN Suppliers ON Stock_orders.supplier_id = Suppliers.id
JOIN Store ON Stock_orders.store_id = Store.id
WHERE Stock_orders.date_recieved IS NULL;

-- Janet wants to know which authors have sold above the expected target.
SELECT Q.Author, Q.Quantity FROM (
	SELECT 
	Books.author_id,
	SUM(Items_sold.quantity) AS 'Quantity',
    Authors.name AS 'Author'
	FROM Items_sold
	JOIN Books ON Items_sold.book_id = Books.id
	JOIN Sales ON Items_sold.sale_id = Sales.id
    JOIN Authors ON Books.author_id = Authors.id
	GROUP BY Items_sold.book_id) Q
GROUP BY Q.author_id
HAVING Q.Quantity >= 3;

-- Trigger
DROP TRIGGER IF EXISTS Book_store.Update_inventory;
DELIMITER //
CREATE TRIGGER Book_store.Update_inventory
AFTER INSERT
ON books
FOR EACH ROW
BEGIN
  INSERT INTO Inventory(Book_id, Store_id, Stock_level)
  VALUES (NEW.id, 1, 0),
  (NEW.id, 2, 0),
  (NEW.id, 3, 0),
  (NEW.id, 4, 0),
  (NEW.id, 5, 0);
END //

DELIMITER ;

INSERT INTO Books (Title, Author_id, Published_year, Genre, Cost)
VALUES("House of flame and shadow", 17, "2023-06-30", "Fantasy", 8.99);

SELECT * FROM Inventory;

SELECT * FROM Books
WHERE id = 110;

SELECT * FROM Inventory
WHERE Book_id = 110;

